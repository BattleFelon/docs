---
title: Authentication Protocols
template: default
---

Okami provides several options for authenticating against it's CBOR and MQTT APIs, some are definitely better than others, but which you choose will be determined by a combination of what your hardware can support, what your infrastructure can support, and the level of security your application requires.

> Note: at this time, all methods are available on the CBOR protocol, but only Token and TLS are available for MQTT.

# Token

The most basic form of authentication that is supported is token-based auth, sometimes referred to as password auth. In this mode you provide a 40 character static UTF-8 token when first establishing a connection. If you've used Exosite's previous APIs this is very similar to a CIK.

Tokens are generated by Okami and must be stored by the device when it is received. Tokens are only provided once.

Token based auth is less secure for several reasons. In the event of a breach of Exosite's platform an attacker would be able to get the full key to impersonate a device completely. Devices using external certificate stores, such as Android and iOS devices, may be subjected to MITM attacks by privileged adversaries. Embedded devices are less able to store key in a manner that is resistant to physical attack.

## Pros

- Trivial to implement
- No special requirements for hardware
- No special requirements for software

## Cons

- Is less secure
  - Vulnerable to platform breach
  - Vulnerable to MITM attacks in some instances
  - Harder to secure against physical attacks

# Hash

The hash auth method is a step up from token based auth. It still uses a single shared key, but once the key is stored in the device it is never sent over the network again. Instead it is used as part of a cryptographic hash which can be created independent on the device and platform, it is this hash which is sent from the device to the platform to prove it's identity.

Secret keys are generated by Okami and must be stored by the device when it is received. Keys are only provided once.

## Pros

- Fairly easy to implement
- No special requirements for hardware
- No special requirements for software
- More resistant to MITM attacks by privileged adversaries

## Cons

- Is less secure
  - Vulnerable to platform breach
  - Harder to secure against physical attacks

# Raw Public/Private Key

The raw public/private key auth method (PPK) is the second strongest auth mode available. It is theoretically identical in strength to client cert auth (see next section), but since the system as a whole is not a formal standard it has seen less public review and we therefore must consider it less secure.

PPK uses a pair of keys, one public, one private, to establish cryptographically the identity of the deivce. A challenge is sent to the device in the form of pseudo-random data which the device then signs with it's private key and returns to the platform. The platform then uses the device's public key to validate the signature. If the response does validate the connection is then fully established.

In this mode the private key of the device can be generated and stored in a bespoke piece of hardware designed to make of the key effectively impossible.

Key pairs are generated on the device and the public key is sent to okami during initial provisioning. generally keys are never updated.

# Pros

- Highly Secure

# Cons

- May require additional hardware.
- May require additional development.

# Client Certificate

The TLS Client Certificate auth method (cert auth) is the strongest method available. When combined with hardware crypto accelerators with secure key storage it is virtually immune to the majority of attacks.

Client certs are part of the TLS standard, therefore cert auth is usually implemented with in a TLS library completely. This means that it is less prone to implementation errors added by end device firmware developers as common implementations will be reviewed more throughly than bespoke implementations. Additionally because the authentication information is transmitted as part of the TLS handshake, this more is more efficient than any of the other available auth methods. This means connections are established faster which can improve performance, increase battery life, and decrease data use.

Key pairs are generated on the device and the public key is sent to okami during initial provisioning, generally keys are never updated.

# Pros

- Highest Possible Security
- Reduces connection overhead & connection setup time

# Cons

- May require additional hardware.
- May require additional development.
